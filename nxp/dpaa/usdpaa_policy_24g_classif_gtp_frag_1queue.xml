<?xml version="1.0" encoding="utf-8"?>
<!--
  SPDX-License-Identifier: BSD-3-Clause

  Copyright 2021 NXP
-->

<netpcd xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:noNamespaceSchemaLocation="xmlProject/pcd.xsd" name="example"
	description="Bridging configuration">

<!--	xxxxxxxxxxxxxxxxxxxxxxxx Distributions xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->

	<vsp name="shared_mac_pool" base="0"/>
	<vsp name="dpdk_mac3_flows" base="1"/>
	<vsp name="dpdk_mac4_flows" base="1"/>
	<vsp name="dpdk_mac5_flows" base="1"/>
	<vsp name="dpdk_mac6_flows" base="1"/>
	<vsp name="dpdk_mac9_flows" base="1"/>
	<vsp name="dpdk_mac10_flows" base="1"/>

	<classification name="dpdk_mac3_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac3_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac3_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac3_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac3_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac3_flows"/>
			<data>0x868</data>
			<queue base="0x700" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac3_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x55"/>
		<action type="classification" name="dpdk_mac3_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac3_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac3_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0x700" count="1"/>
		<action type="classification" name="dpdk_mac3_mf_classif"/>
	</distribution>

	<classification name="dpdk_mac4_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac4_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac4_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac4_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac4_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac4_flows"/>
			<data>0x868</data>
			<queue base="0x800" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac4_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x57"/>
		<action type="classification" name="dpdk_mac4_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac4_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac4_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0x800" count="1"/>
		<action type="classification" name="dpdk_mac4_mf_classif"/>
	</distribution>




	<classification name="dpdk_mac5_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac5_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac5_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac5_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac5_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac5_flows"/>
			<data>0x868</data>
			<queue base="0x900" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac5_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x59"/>
		<action type="classification" name="dpdk_mac5_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac5_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac5_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0x900" count="1"/>
		<action type="classification" name="dpdk_mac5_mf_classif"/>
	</distribution>


	<classification name="dpdk_mac6_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac6_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac6_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac6_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac6_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac6_flows"/>
			<data>0x868</data>
			<queue base="0xa00" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac6_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x5b"/>
		<action type="classification" name="dpdk_mac6_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac6_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac6_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0xa00" count="1"/>
		<action type="classification" name="dpdk_mac6_mf_classif"/>
	</distribution>




	<classification name="dpdk_mac9_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac9_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac9_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac9_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac9_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac9_flows"/>
			<data>0x868</data>
			<queue base="0xd00" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac9_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x5d"/>
		<action type="classification" name="dpdk_mac9_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac9_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac9_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0xd00" count="1"/>
		<action type="classification" name="dpdk_mac9_mf_classif"/>
	</distribution>




	<classification name="dpdk_mac10_mf_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.mf"/>
		</key>
		<entry>
			<!-- If mf is 0, check for next condition-->
			<!-- If mf is non zero(one), send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="classification" name="dpdk_mac10_foffset_classif"/>
		</entry>
	</classification>

	<classification name="dpdk_mac10_foffset_classif" masks="yes">
		<key>
			<fieldref name ="ipv4.foffset"/>
		</key>
		<entry>
			<!-- If foffset is 0, check for next condition-->
			<!-- If foffset is non zero, send packet to default queue(userspace queue)-->
			<data>0x0</data>
			<action type="distribution" name="gtp_mac10_dist"/>
		</entry>
	</classification>

	<classification name="dpdk_mac10_gtp_classif" masks="yes">
		<key>
			<fieldref name ="udp.dport"/>
		</key>
		<entry>
			<!-- If udp.dport is 2152(0x868), send packet to userspace queue-->
			<!-- If udp.dport is not 2152, send packet to default queue(kernel queue)-->
			<!-- This queue is userspace queue-->
			<vsp name="dpdk_mac10_flows"/>
			<data>0x868</data>
			<queue base="0xe00" count="1"/>
		</entry>
	</classification>

	<distribution name="gtp_mac10_dist">
		<!-- Distribution based on GTP/non-GTP packet-->
		<!-- Default queue is kernel queue-->
		<vsp name="shared_mac_pool"/>
		<protocols>
			<protocolref name="udp"/>
		</protocols>
		<queue count="1" base="0x5f"/>
		<action type="classification" name="dpdk_mac10_gtp_classif"/>
	</distribution>

	<distribution name="frag_gtp_mac10_dist">
		<!-- Distribution based on fragmented/non-fragmented packet-->
		<!-- Default queue is userspace queue-->
		<vsp name="dpdk_mac10_flows"/>
		<protocols>
			<protocolref name="ipv4"/>
		</protocols>
		<queue base="0xe00" count="1"/>
		<action type="classification" name="dpdk_mac10_mf_classif"/>
	</distribution>


<!--	xxxxxxxxxxxxxxxxxxxxxxxxxx Policies xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->

	<policy name="fm_policy_3">
		<dist_order>
			<distributionref name="frag_gtp_mac3_dist"/>
		</dist_order>
	</policy>

	<policy name="fm_policy_4">
		<dist_order>
			<distributionref name="frag_gtp_mac4_dist"/>
		</dist_order>
	</policy>

	<policy name="fm_policy_5">
		<dist_order>
			<distributionref name="frag_gtp_mac5_dist"/>
		</dist_order>
	</policy>

	<policy name="fm_policy_6">
		<dist_order>
			<distributionref name="frag_gtp_mac6_dist"/>
		</dist_order>
	</policy>

	<policy name="fm_policy_9">
		<dist_order>
			<distributionref name="frag_gtp_mac9_dist"/>
		</dist_order>
	</policy>

	<policy name="fm_policy_10">
		<dist_order>
			<distributionref name="frag_gtp_mac10_dist"/>
		</dist_order>
	</policy>
</netpcd>
